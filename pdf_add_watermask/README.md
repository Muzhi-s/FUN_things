# PDF Add Watermark Tool

这是一个轻量级的 Python 工具，用于批量为 PDF 文件添加重复平铺的文字水印。它基于 `PyPDF2` 和 `reportlab` 库开发，特别优化了对中文字体的支持。

## ✨ 功能特点

- **文本水印**：支持自定义任意文本作为水印。
- **中文支持**：内置中文字体自动寻找机制（优先查找 SimHei、微软雅黑等），解决中文乱码问题。
- **全屏平铺**：水印以网格形式覆盖整个页面，支持旋转。
- **高度可配**：支持调整旋转角度、透明度、字号、密度（间距）、灰度等。

## 🛠️ 环境准备

在使用之前，请确保已安装 Python 3 环境，并安装以下依赖库：

```bash
pip install PyPDF2 reportlab
```

## 🚀 快速开始

1. **准备文件**：
   将你需要处理的 PDF 文件放入项目目录（或者记录下它的绝对路径）。

2. **配置参数**：
   打开 `add.py` 文件，找到底部的 `if __name__ == "__main__":` 区域，修改输入输出文件名和水印文字：

   ```python
   input_pdf = "你的文件.pdf"               # 输入文件路径
   output_pdf = "带水印_output.pdf"         # 输出文件路径
   watermark_text = "严禁外传 仅供核对"      # 水印内容
   ```

3. **运行脚本**：
   在终端中运行以下命令：

   ```bash
   python add.py
   ```
   
   运行成功后，终端会显示生成文件的路径。

## ⚙️ 参数调整

你可以通过修改代码中的 `opts` 字典来微调水印样式：

| 参数 | 说明 | 默认值 | 推荐范围 |
| :--- | :--- | :--- | :--- |
| `angle` | 水印旋转角度 | 45 | 30 - 60 |
| `font_size` | 字体大小 | 40 | 20 - 60 |
| `alpha` | 透明度 (0-1) | 0.18 | 0.1 - 0.3 (越小越淡) |
| `fill_gray` | 字体灰度 (0黑-1白) | 0.5 | 0.3 - 0.7 |
| `gap_x` | 水印横向间距 | 300 | 200 - 500 |
| `gap_y` | 水印纵向间距 | 240 | 200 - 500 |

## 📝 关于中文字体

脚本会自动按以下顺序寻找中文字体：
1. 当前目录下的 `simhei.ttf`
2. Windows 系统字体 `C:\Windows\Fonts\simhei.ttf` (黑体)
3. Windows 系统字体 `C:\Windows\Fonts\msyh.ttc` (微软雅黑)

**如果中文显示为空或乱码**：
请下载 `simhei.ttf` 或其他支持中文的字体文件，直接放到脚本同级目录下即可自动识别。
